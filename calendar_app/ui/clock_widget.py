import tkinter as tk
from datetime import datetime
from ui.theme import COLORS

class ClockWidget:
    """
    å³ä¸‹ã«ç¾åœ¨æ™‚åˆ»ã‚’è¡¨ç¤ºã™ã‚‹ã‚¦ã‚£ã‚¸ã‚§ãƒƒãƒˆã€‚

    ãƒ»è¦ªã‚¦ã‚£ã‚¸ã‚§ãƒƒãƒˆã«ãƒ•ã‚£ãƒƒãƒˆã™ã‚‹ãƒ•ãƒ¬ãƒ¼ãƒ ã‚’ä½œæˆ
    ãƒ»1ç§’ã”ã¨ã«æ™‚åˆ»ã‚’æ›´æ–°
    """
    def __init__(self, parent):
        # â”€â”€â”€ ãƒ•ãƒ¬ãƒ¼ãƒ ã®ä½œæˆ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
        # èƒŒæ™¯è‰²ã¯ãƒ˜ãƒƒãƒ€ãƒ¼ã¨åˆã‚ã›ã‚‹ã‹ã€ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã‚’ä½¿ã†
        bg_color = COLORS.get("header_bg", "#F9F9F9")
        self.frame = tk.Frame(parent, bg=bg_color)
        # ä½™ç™½ã‚’è©°ã‚ãšã«ä¼¸ç¸®ã•ã›ã‚‹
        self.frame.pack(fill="both", expand=True)

        # â”€â”€â”€ æ™‚è¨ˆãƒ©ãƒ™ãƒ«ã®ä½œæˆ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
        # ãƒ•ã‚©ãƒ³ãƒˆã¯è»½ã‚„ã‹ãªã‚»ã‚´ã‚¨UIã€è‰²ã¯è–„ã„ã‚°ãƒ¬ãƒ¼
        self.label = tk.Label(
            self.frame,
            text="",                # åˆæœŸãƒ†ã‚­ã‚¹ãƒˆã¯ç©º
            font=("Segoe UI", 11),  # ãƒ•ã‚©ãƒ³ãƒˆã‚µã‚¤ã‚º11pt
            bg=bg_color,            # ãƒ•ãƒ¬ãƒ¼ãƒ ã¨åŒã˜èƒŒæ™¯
            fg="#555555",           # è–„ã„ã‚°ãƒ¬ãƒ¼æ–‡å­—
            anchor="se",            # å³ä¸‹å¯„ã›
            padx=8,                 # å†…å´ä½™ç™½å·¦å³8px
            pady=5                  # å†…å´ä½™ç™½ä¸Šä¸‹5px
        )
        # å³ä¸‹ã«ãƒ‘ãƒ‡ã‚£ãƒ³ã‚°ã‚’å–ã‚ŠãªãŒã‚‰é…ç½®
        self.label.pack(anchor="se", padx=10, pady=8)

        # â”€â”€â”€ æ™‚åˆ»æ›´æ–°ãƒ«ãƒ¼ãƒ—é–‹å§‹ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
        self._update_clock()

    def _update_clock(self):
        """
        ãƒ©ãƒ™ãƒ«ã«ç¾åœ¨æ™‚åˆ»ã‚’è¨­å®šã—ã€1ç§’å¾Œã«å†åº¦è‡ªåˆ†ã‚’å‘¼ã³å‡ºã™ã€‚
        """
        # ç¾åœ¨æ—¥æ™‚ã‚’ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆ
        now_str = datetime.now().strftime("%Y-%m-%d %H:%M:%S")
        # ãƒ©ãƒ™ãƒ«ã«æ—¥æ™‚ã‚’ã‚»ãƒƒãƒˆï¼ˆå…ˆé ­ã«ã‚¢ã‚¤ã‚³ãƒ³ï¼‹ã‚¹ãƒšãƒ¼ã‚¹ï¼‰
        self.label.config(text=f"ğŸ•’ {now_str}")
        # 1,000ãƒŸãƒªç§’å¾Œã«å†å®Ÿè¡Œ
        self.label.after(1000, self._update_clock)
